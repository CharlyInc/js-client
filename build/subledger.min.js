/*! Subledger 1.1.1 | (c) 2015 Subledger | https://github.com/subledger/js-client/blob/master/LICENSE.txt */
!function(exports){var Subledger,helpers,Ajax,Base64;Subledger=function(){this.url="https://api.subledger.com/v2",this.oauth_consumer_key=null,this.oauth_consumer_secret=null,this._ajax=new Ajax},Subledger.prototype.setCredentials=function(a,b){var c=this;c.oauth_consumer_key=a,c.oauth_consumer_secret=b,c._ajax.setCredentials(c.oauth_consumer_key,c.oauth_consumer_secret)},Subledger.prototype.identity=function(a){var b=this,c={},d=b._ajax;return c.identity_id=a,c.url=b.url+"/identities",c.create=function(a,b){d.post(c.url,a,b)},c.identity_id&&null!==b.oauth_consumer_key&&null!==b.oauth_consumer_secret&&(c.get=function(a){d.get(c.url+"/"+c.identity_id,a)},c.update=function(a,b){d.patch(c.url+"/"+c.identity_id,a,b)},c.key=function(a){var b={};return b.key_id=a,b.url=c.url+"/"+c.identity_id+"/keys",b.create=function(a,c){helpers.isFunction(a)&&(c=a,a={}),d.post(b.url,a,c)},b.key_id&&(b.get=function(a){d.get(b.url+"/"+b.key_id,a)},b.activate=function(a){d.post(b.url+"/"+b.key_id+"/activate",a)},b.archive=function(a){d.post(b.url+"/"+b.key_id+"/archive",a)}),b}),c},Subledger.prototype.org=function(a){var b=this,c={},d=b._ajax;return c.org_id=a,c.url=b.url+"/orgs",null!==b.oauth_consumer_key&&null!==b.oauth_consumer_secret&&(c.create=function(a,b){d.post(c.url,a,b)},c.org_id&&(c.get=function(a){d.get(c.url+"/"+c.org_id,a)},c.update=function(a,b){d.patch(c.url+"/"+c.org_id,a,b)},c.activate=function(a){d.post(c.url+"/"+c.org_id+"/activate",a)},c.archive=function(a){d.post(c.url+"/"+c.org_id+"/archive",a)},c.book=function(a){var b={};return b.book_id=a,b.url=c.url+"/"+c.org_id+"/books",b.get=function(a,c){helpers.isFunction(a)&&(c=a,a={}),b.book_id?d.get(b.url+"/"+b.book_id,c):(a.state=a.state||"active",a.action=a.action||"ending","ending"!==a.action&&"before"!==a.action||a.description?"starting"!==a.action&&"after"!==a.action||a.description||(a.description=0):a.description=255,d.get(b.url+"?"+helpers.encodeQueryObj(a),c))},b.create=function(a,c){d.post(b.url,a,c)},b.book_id&&(b.update=function(a,c){d.patch(b.url+"/"+b.book_id,a,c)},b.activate=function(a){d.post(b.url+"/"+b.book_id+"/activate",a)},b.archive=function(a){d.post(b.url+"/"+b.book_id+"/archive",a)},b.account=function(a){var c={};return c.account_id=a,c.url=b.url+"/"+b.book_id+"/accounts",c.get=function(a,b){helpers.isFunction(a)&&(b=a,a={}),c.account_id?d.get(c.url+"/"+c.account_id,b):(a.state=a.state||"active",a.action=a.action||"ending","ending"!==a.action&&"before"!==a.action||a.description?"starting"!==a.action&&"after"!==a.action||a.description||(a.description=0):a.description=255,d.get(c.url+"?"+helpers.encodeQueryObj(a),b))},c.create=function(a,b){d.post(c.url,a,b)},c.account_id&&(c.update=function(a,b){d.patch(c.url+"/"+c.account_id,a,b)},c.activate=function(a){d.post(c.url+"/"+c.account_id+"/activate",a)},c.archive=function(a){d.post(c.url+"/"+c.account_id+"/archive",a)},c.balance=function(a,b){helpers.isFunction(a)&&(b=a,a={}),a.at=a.at||(new Date).toISOString(),d.get(c.url+"/"+c.account_id+"/balance?"+helpers.encodeQueryObj(a),b)},c.line=function(a){var b={};return b.line_id=a,b.url=c.url+"/"+c.account_id+"/lines",b.get=function(a,c){helpers.isFunction(a)&&(c=a,a={}),b.line_id?d.get(b.url+"/"+b.line_id,c):(a.action=a.action||"ending",a.effective_at=a.effective_at||(new Date).toISOString(),d.get(b.url+"?"+helpers.encodeQueryObj(a),c))},b},c.firstAndLastLine=function(a){d.get(c.url+"/"+c.account_id+"/first_and_last_line",a)}),c},b.journalEntry=function(a){var c={};return c.journal_entry_id=a,c.url=b.url+"/"+b.book_id+"/journal_entries",c.get=function(a,b){helpers.isFunction(a)&&(b=a,a={}),c.journal_entry_id?d.get(c.url+"/"+c.journal_entry_id,b):(a.state=a.state||"active",a.action=a.action||"ending",a.effective_at=a.effective_at||(new Date).toISOString(),d.get(c.url+"?"+helpers.encodeQueryObj(a),b))},c.create=function(a,b){console.warn("journalEntry().create() is deprecated and should be replaced with journalEntry().createAndPost()."),d.post(c.url,a,b)},c.createAndPost=function(a,b){d.post(c.url+"/create_and_post",a,b)},c.journal_entry_id&&(c.post=function(a){d.post(c.url+"/"+c.journal_entry_id,a)},c.update=function(a,b){console.warn("journalEntry().update() is deprecated and should not be used."),d.patch(c.url+"/"+c.journal_entry_id,a,b)},c.activate=function(a){d.post(c.url+"/"+c.journal_entry_id+"/activate",a)},c.archive=function(a){d.post(c.url+"/"+c.journal_entry_id+"/archive",a)},c.balance=function(a){console.warn("journalEntry().balance() is deprecated and should not be used."),d.get(c.url+"/"+c.journal_entry_id+"/balance",a)},c.progress=function(a){d.get(c.url+"/"+c.journal_entry_id+"/progress",a)},c.line=function(a){var b={};return b.line_id=a,b.url=c.url+"/"+c.journal_entry_id+"/lines",b.get=function(a,c){helpers.isFunction(a)&&(c=a,a={}),b.line_id?d.get(b.url+"/"+b.line_id,c):(a.state=a.state||"posted",a.action=a.action||"starting",d.get(b.url+"?"+helpers.encodeQueryObj(a),c))},b.create=function(a,b){console.warn("journalEntry().line().create() is deprecated and should not be used."),d.post(c.url+"/"+c.journal_entry_id+"/create_line",a,b)},b.line_id&&(b.update=function(a,c){console.warn("journalEntry().line().update() is deprecated and should not be used."),d.patch(b.url+"/"+b.line_id,a,c)},b.activate=function(a){console.warn("journalEntry().line().activate() is deprecated and should not be used."),d.post(b.url+"/"+b.line_id+"/activate",a)},b.archive=function(a){console.warn("journalEntry().line().archive() is deprecated and should not be used."),d.post(b.url+"/"+b.line_id+"/archive",a)}),b}),c},b.category=function(a){var c={};return c.category_id=a,c.url=b.url+"/"+b.book_id+"/categories",c.get=function(a,b){helpers.isFunction(a)&&(b=a,a={}),c.category_id?d.get(c.url+"/"+c.category_id,b):(a.state=a.state||"active",a.action=a.action||"ending","ending"!==a.action&&"before"!==a.action||a.description?"starting"!==a.action&&"after"!==a.action||a.description||(a.description=0):a.description=255,d.get(c.url+"?"+helpers.encodeQueryObj(a),b))},c.create=function(a,b){d.post(c.url,a,b)},c.category_id&&(c.update=function(a,b){d.patch(c.url+"/"+c.category_id,a,b)},c.attach=function(a,b){d.post(c.url+"/"+c.category_id+"/attach",a,b)},c.detach=function(a,b){d.post(c.url+"/"+c.category_id+"/detach",a,b)},c.archive=function(a){d.post(c.url+"/"+c.category_id+"/archive",a)},c.activate=function(a){d.post(c.url+"/"+c.category_id+"/activate",a)}),c},b.report=function(a){var c={};return c.report_id=a,c.url=b.url+"/"+b.book_id+"/reports",c.get=function(a,b){helpers.isFunction(a)&&(b=a,a={}),c.report_id?d.get(c.url+"/"+c.report_id,b):(a.state=a.state||"active",a.action=a.action||"ending","ending"!==a.action&&"before"!==a.action||a.description?"starting"!==a.action&&"after"!==a.action||a.description||(a.description=0):a.description=255,d.get(c.url+"?"+helpers.encodeQueryObj(a),b))},c.create=function(a,b){d.post(c.url,a,b)},c.report_id&&(c.update=function(a,b){d.patch(c.url+"/"+c.report_id,a,b)},c.attach=function(a,b){d.post(c.url+"/"+c.report_id+"/attach",a,b)},c.detach=function(a,b){d.post(c.url+"/"+c.report_id+"/detach",a,b)},c.render=function(a,b){helpers.isFunction(a)&&(b=a,a={}),a.at=a.at||(new Date).toISOString(),d.post(c.url+"/"+c.report_id+"/render?"+helpers.encodeQueryObj(a),b)},c.archive=function(a){d.post(c.url+"/"+c.report_id+"/archive",a)},c.activate=function(a){d.post(c.url+"/"+c.report_id+"/activate",a)}),c},b.report_rendering=function(a){var c={};return c.report_rendering_id=a,c.url=b.url+"/"+b.book_id+"/report_renderings",c.get=function(a){d.get(c.url+"/"+c.report_rendering_id,a)},c}),b})),c},Subledger.prototype.organization=Subledger.prototype.org,helpers={isArray:Array.isArray||function(a){return"[object Array]"===toString.call(a)},isObject:function(a){return"[object Object]"===toString.call(a)},isFunction:function(a){return!!(a&&a.constructor&&a.call&&a.apply)},encodeQueryObj:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(encodeURIComponent(b)+"="+encodeURIComponent(a[b]));return c.join("&")},removeTrailingSlash:function(a){return a.replace(/\/*$/,"")}},Ajax=function(){function a(){this._callbacks=[]}function b(){var a,b;if("undefined"==typeof window)b=require("xmlhttprequest").XMLHttpRequest,a=new b;else if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function c(a,b){var c,d;return d=a+":"+b,c=Base64.encode(d),"Basic "+c}function d(d,e,f,i){function j(){l.abort(),k.done(g.ETIMEOUT,"",l)}var k,l,m,n,o,p;k=new a,f=f||{},i=i||{};try{l=b()}catch(q){return k.done(g.ENOXHR,""),k}m=JSON.stringify(f),"GET"===d&&m&&(m=null),l.open(d,e),l.setRequestHeader("Accept","application/json"),l.setRequestHeader("Content-type","application/json"),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),null!==h.oauth_consumer_key&&null!==h.oauth_consumer_secret&&l.setRequestHeader("Authorization",c(h.oauth_consumer_key,h.oauth_consumer_secret));for(n in i)i.hasOwnProperty(n)&&l.setRequestHeader(n,i[n]);return o=g.ajaxTimeout,o&&(p=setTimeout(j,o)),l.onreadystatechange=function(){var a;o&&clearTimeout(p),4===l.readyState&&(a=l.status?l.status<200?!0:l.status>=300&&304!==l.status?!0:!1:!0,k.done(a,l.responseText,l))},l.send(m),k}function e(a){return function(b,c,e){return d(a,b,c,e)}}function f(a,b){var c={};return c.data=""!==b?JSON.parse(b):{},c.err=a?new Error(c.data.exception||""):null,c}var g,h=this;h.oauth_consumer_key=null,h.oauth_consumer_secret=null,a.prototype.then=function(b,c){var d;return this._isdone?d=b.apply(c,this.result):(d=new a,this._callbacks.push(function(){var a=b.apply(c,arguments);a&&"function"==typeof a.then&&a.then(d.done,d)})),d},a.prototype.done=function(){var a;for(this.result=arguments,this._isdone=!0,a=0;a<this._callbacks.length;a+=1)this._callbacks[a].apply(null,arguments);this._callbacks=[]},g={get:e("GET"),post:e("POST"),put:e("PUT"),patch:e("PATCH"),del:e("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0},this.get=function(a,b){g.get(a).then(function(a,c){return c=f(a,c),b(c.err,c.data)})},this.post=function(a,b,c){helpers.isFunction(b)&&(c=b,b={}),g.post(a,b).then(function(a,b){return b=f(a,b),c(b.err,b.data)})},this.put=function(a,b,c){helpers.isFunction(b)&&(c=b,b={}),g.put(a,b).then(function(a,b){return b=f(a,b),c(b.err,b.data)})},this.patch=function(a,b,c){helpers.isFunction(b)&&(c=b,b={}),g.patch(a,b).then(function(a,b){return b=f(a,b),c(b.err,b.data)})},this.del=function(a,b){g.del(a).then(function(a,c){return c=f(a,c),b(c.err,c.data)})}},Ajax.prototype.setCredentials=function(a,b){var c=this;c.oauth_consumer_key=a,c.oauth_consumer_secret=b},Base64=function(){function a(){this.buffer=[]}function b(a){this._input=a,this._index=-1,this._buffer=[]}function c(a){this._input=a,this._index=-1,this._buffer=[]}a.prototype.append=function(a){return this.buffer.push(a),this},a.prototype.toString=function(){return this.buffer.join("")},b.prototype={current:NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=NaN,!1;var a=this._input.charCodeAt(++this._index);return 13===a&&10===this._input.charCodeAt(this._index+1)&&(a=10,this._index+=2),128>a?this.current=a:a>127&&2048>a?(this.current=a>>6|192,this._buffer.push(63&a|128)):(this.current=a>>12|224,this._buffer.push(a>>6&63|128),this._buffer.push(63&a|128)),!0}},c.prototype={current:64,moveNext:function(){var a,b,c,e,f,g,h;return this._buffer.length>0?(this.current=this._buffer.shift(),!0):this._index>=this._input.length-1?(this.current=64,!1):(a=d.codex.indexOf(this._input.charAt(++this._index)),b=d.codex.indexOf(this._input.charAt(++this._index)),c=d.codex.indexOf(this._input.charAt(++this._index)),e=d.codex.indexOf(this._input.charAt(++this._index)),f=a<<2|b>>4,g=(15&b)<<4|c>>2,h=(3&c)<<6|e,this.current=f,64!==c&&this._buffer.push(g),64!==e&&this._buffer.push(h),!0)}};var d={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var d,e,f,g,h,i,j,k,l;for(d=new a,e=new b(c);e.moveNext();)f=e.current,e.moveNext(),g=e.current,e.moveNext(),h=e.current,i=f>>2,j=(3&f)<<4|g>>4,k=(15&g)<<2|h>>6,l=63&h,isNaN(g)?k=l=64:isNaN(h)&&(l=64),d.append(this.codex.charAt(i)+this.codex.charAt(j)+this.codex.charAt(k)+this.codex.charAt(l));return d.toString()},decode:function(b){var d,e,f,g,h;for(d=new a,f=!1,h=new c(b);h.moveNext();)e=h.current,128>e?d.append(String.fromCharCode(e)):e>191&&224>e?(h.moveNext(),f=h.current,d.append(String.fromCharCode((31&e)<<6|63&f))):(h.moveNext(),f=h.current,h.moveNext(),g=h.current,d.append(String.fromCharCode((15&e)<<12|(63&f)<<6|63&g)));return d.toString()}};return d}(),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function a(a){return 10>a?"0"+a:a}return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),exports.Subledger=Subledger}(this);